<!DOCTYPE HTML>
<html>
<head>
  <title>Test MediaStreamAudioSourceNode</title>
  <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css" />
</head>
<body>
  <!-- <audio src="sin440-22k.wav" controls></audio> -->
  <!-- <audio src="sin440-24k.wav" controls></audio> -->
  <!-- <audio src="sin440-48k.wav" controls></audio> -->
  <audio src="sin440-82k.wav" controls></audio>
  <!-- <audio src="sin440-96k.wav" controls></audio> -->
  <!-- <audio src="audio-expected.wav" controls></audio> -->
  <!-- <audio src="audio.ogv" controls></audio> -->
  <!-- <audio src="ting-dualchannel44.1.ogg" controls loop="true"></audio> -->
  <!-- <audio src="ehsan.wav" controls></audio> -->
  <script type="text/javascript">
    var context = new AudioContext();

    var audio = document.querySelector('audio');

    audio.addEventListener('canplay', function onCanPlay (e) {
      audio.removeEventListener('canplay', onCanPlay, false);
      var stream = audio.mozCaptureStream();
      var source = context.createMediaStreamSource(stream);
      source.connect(context.destination);
      audio.play();
    }, false);

    audio.load();
  </script>
</body>
</html>
